{
  "hash": "a140ddfd363e3d9d09b9100eb0c33f1c",
  "result": {
    "markdown": "---\ntitle: \"Randomized Controlled Trials\"\n---\n\n\n\n\n# Assignments\n\n1. Covariates Balance Plots\n\n::: {.cell hash='06_rct_cache/html/unnamed-chunk-2_29b78c2edfafc11864ed10272693584e'}\n\n```{.r .cell-code}\nm.out <- MatchIt::matchit(chatbot ~ previous_visit + mobile_device, data = abtest_online)\nbal.plot(m.out, var.name = \"previous_visit\")\n```\n\n::: {.cell-output-display}\n![](06_rct_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\nbal.plot(m.out, var.name = \"mobile_device\")\n```\n\n::: {.cell-output-display}\n![](06_rct_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n:::\n\n\nFrom the plots we observe that in general, the covariates are balanced across the groups. However, for `previous_visit` there are slightly fewer control units than treated units so that not all units get a match. Especially, the plot \"Distributional Balance for `previous_visit`\" shows that the from `previous_visit = 7`, there are no control units matched to the treated units.\n\n2. Regress `chatbot` on `purchase_amount`\n\n::: {.cell hash='06_rct_cache/html/unnamed-chunk-3_f1694083661d29b4367b1f8ff5edebad'}\n\n```{.r .cell-code}\n# Functions used in R for the task\nlm_sales <- lm(purchase_amount ~ chatbot, data = abtest_online)\nsummary(lm_sales)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = purchase_amount ~ chatbot, data = abtest_online)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -16.702 -14.478  -9.626  13.922  64.648 \n#> \n#> Coefficients:\n#>             Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)  16.7017     0.8374  19.944  < 2e-16 ***\n#> chatbotTRUE  -7.0756     1.1796  -5.998 2.79e-09 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 18.65 on 998 degrees of freedom\n#> Multiple R-squared:  0.0348,\tAdjusted R-squared:  0.03383 \n#> F-statistic: 35.98 on 1 and 998 DF,  p-value: 2.787e-09\n```\n:::\n\n```{.r .cell-code}\njtools::effect_plot(lm_sales, pred = chatbot)\n```\n\n::: {.cell-output-display}\n![](06_rct_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nThe coefficient of the regression is $-7.0756$ for `chatbot = TRUE`. This means that the sales dropped for the group of customers that were directed to a chatbot. The result also reflects in the plot. \n\n3. The chosen subgroup is mobile users.\n\n::: {.cell hash='06_rct_cache/html/unnamed-chunk-4_669fcb7f76260b098c526b7421943efb'}\n\n```{.r .cell-code}\n# Functions used in R for the task\nlm_CATE <- lm(purchase_amount ~ chatbot*mobile_device, data = abtest_online)\nsummary(lm_CATE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = purchase_amount ~ chatbot * mobile_device, data = abtest_online)\n#> \n#> Residuals:\n#>    Min     1Q Median     3Q    Max \n#> -16.98 -14.54  -9.95  14.13  65.24 \n#> \n#> Coefficients:\n#>                               Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)                    16.9797     1.0152  16.725   <2e-16 ***\n#> chatbotTRUE                    -7.0301     1.4284  -4.922    1e-06 ***\n#> mobile_deviceTRUE              -0.8727     1.7987  -0.485    0.628    \n#> chatbotTRUE:mobile_deviceTRUE  -0.1526     2.5369  -0.060    0.952    \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 18.66 on 996 degrees of freedom\n#> Multiple R-squared:  0.03534,\tAdjusted R-squared:  0.03244 \n#> F-statistic: 12.16 on 3 and 996 DF,  p-value: 8.034e-08\n```\n:::\n:::\n\n\n4. Logistic regression of `purchase`\n\n::: {.cell hash='06_rct_cache/html/unnamed-chunk-5_0a38ce80491d17f75a9df8154dd6ee4e'}\n\n```{.r .cell-code}\n# Functions used in R for the task\nlogreg <- glm(purchase ~ chatbot, data = abtest_online, family=binomial)\nsummary(logreg)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> glm(formula = purchase ~ chatbot, family = binomial, data = abtest_online)\n#> \n#> Coefficients:\n#>             Estimate Std. Error z value Pr(>|z|)    \n#> (Intercept) -0.01613    0.08981  -0.180    0.857    \n#> chatbotTRUE -0.98939    0.13484  -7.337 2.18e-13 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> (Dispersion parameter for binomial family taken to be 1)\n#> \n#>     Null deviance: 1329.1  on 999  degrees of freedom\n#> Residual deviance: 1273.3  on 998  degrees of freedom\n#> AIC: 1277.3\n#> \n#> Number of Fisher Scoring iterations: 4\n```\n:::\n\n```{.r .cell-code}\nodds_ratio <- exp(-0.98939)\npercentage <- odds_ratio/(1+odds_ratio)\n```\n:::\n\n\nThe coefficient for `chatbot = TRUE` is $-0.98939$ which corresponds to the log of odds ratio between the group of customers that used the chatbot and that interacted with human customer service. The log odds is the logarithm of the odds, which is the ratio of something happening to something not happening. The odds ratio equals $0.37$ is less than $1$, which means that it is unlikely that a customer using a chatbot will purchase something. In particular, the odds of purchasing something for customers who didn't use a chatbot are about $27\\%$ higher than the odds for customers who used a chatbot.",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}